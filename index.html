<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Medical Office Training Notebook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #f8f9ff; }
    header { background: #006d77; color: #fff; padding: 1rem 2rem; font-size: 2rem; letter-spacing: .03em; font-weight: bold;}
    nav { background: #edf6f9; padding: 0.5rem 2rem; display: flex; flex-wrap: wrap; gap: 0.7rem; }
    nav button { background: #00b4d8; color: #fff; border: none; border-radius: 5px; padding: 0.4rem 1.2rem; margin: 0.1rem; cursor: pointer; transition: background 0.2s;}
    nav button:hover, nav button.active { background: #03045e; }
    main { max-width: 850px; margin: 2rem auto; background: #fff; border-radius: 8px; box-shadow: 0 4px 16px #b5c8e6a1; padding: 2rem; }
    section { display: none; }
    section.active { display: block; }
    h2 { color: #264653; margin-top: 0; }
    .scenario { background: #e9f7ef; color: #20504f; border-left: 4px solid #00b4d8; padding: 1rem; border-radius: 4px; font-size: 1.1rem; margin-bottom: 1.2rem;}
    form { margin-bottom: 1.2rem; }
    label { display: block; margin-top: 1rem; margin-bottom: 0.4rem; font-weight: bold;}
    input, select, textarea { width: 100%; padding: 0.6em; border: 1px solid #b5c8e6; border-radius: 4px; margin-bottom: 0.5em;}
    input[type="file"] { width: auto; }
    input[type="checkbox"], input[type="radio"] { width: auto; margin-right: 0.4em;}
    .feedback { background: #d8f3dc; border-left: 4px solid #43aa8b; color: #155724; padding: 1rem; margin-bottom: 1rem; border-radius: 4px; font-size: 1.07em; display: none;}
    .error { background: #ffe1e1 !important; border-color: #bc4749 !important; color: #b1001c !important;}
    table { border-collapse: collapse; margin-top: 1.3em; width: 100%; }
    th, td { border: 1px solid #c0d6e4; padding: 0.7em; text-align: left; }
    th { background: #caf0f8; }
    .dashboard-card { display: inline-block; width: 190px; margin: 0.7em 1.2em 1.2em 0; background: #f1faee; border-radius: 8px; box-shadow: 0 2px 7px #b5c8e674; padding: 1em 1em 0.7em 1em; }
    .dashboard-card h4 {margin:0 0 0.5em 0;}
    .small-btn { font-size: 0.9em; color: #0077b6; background: #fff; border: 1px solid #b5c8e6; border-radius: 4px; margin-top: 0.5em; margin-bottom: 0.5em;}
    .small-btn:active { background: #90e0ef; }
    .hidden {display: none;}
    .module-reset { background: none; color: #888; font-size: 0.92em; margin-left: 0.6em; border: none; cursor: pointer; text-decoration: underline;}
    .dashboard-avatar { width: 32px; height: 32px; border-radius: 50%; background: #aad8d3; display: inline-block; vertical-align: middle; margin-right: 0.8em;}
    @media (max-width: 700px) {
      main { padding: 0.6em; }
      .dashboard-card { width: 99%; display: block; margin: 1.2em auto;}
    }
  </style>
</head>
<body>
  <header>
    Medical Office Training Notebook
  </header>
  <nav id="mainNav">
    <button data-module="dashboard" class="active">Dashboard</button>
    <button data-module="registration">Patient Registration</button>
    <button data-module="appointment">Appointment Scheduling</button>
    <button data-module="soap">SOAP Notes</button>
    <button data-module="insurance">Insurance Verification</button>
    <button data-module="messaging">Provider Messaging</button>
    <button data-module="documents">Document Upload</button>
    <button data-module="labs">Lab Orders</button>
    <button data-module="reports">Productivity Reports</button>
    <button data-module="career">Career Path Tracker</button>
    <button data-module="appeals">Appeals Management</button>
    <button data-module="audit">Audit Simulation</button>
    <button data-module="compliance">Compliance Review</button>
    <button data-module="workflows">Advanced Workflows</button>
  </nav>
  <main>
    <!-- DASHBOARD MODULE -->
    <section id="dashboard" class="active">
      <h2>Role-Based Dashboard</h2>
      <div class="scenario">
        <strong>Scenario:</strong> You are a medical office coordinator responsible for managing daily operations. Use the dashboard to quickly access key tasks, view upcoming appointments, review outstanding messages and reports, and track your training progress.
      </div>
      <div style="display:flex; flex-wrap: wrap; gap:0.5em;">
        <div class="dashboard-card">
          <div class="dashboard-avatar"></div>
          <h4>Today's Appointments</h4>
          <div id="dashboard-appointments"></div>
          <button class="small-btn" onclick="showModule('appointment')">Schedule</button>
        </div>
        <div class="dashboard-card">
          <div class="dashboard-avatar" style="background: #edeec9;"></div>
          <h4>Patient Registrations</h4>
          <div id="dashboard-patients"></div>
          <button class="small-btn" onclick="showModule('registration')">Register</button>
        </div>
        <div class="dashboard-card">
          <div class="dashboard-avatar" style="background: #ffe59e;"></div>
          <h4>Provider Messages</h4>
          <div id="dashboard-messages"></div>
          <button class="small-btn" onclick="showModule('messaging')">Inbox</button>
        </div>
        <div class="dashboard-card">
          <div class="dashboard-avatar" style="background: #fae0e4;"></div>
          <h4>Productivity</h4>
          <div id="dashboard-productivity"></div>
          <button class="small-btn" onclick="showModule('reports')">View Reports</button>
        </div>
      </div>
      <div style="margin-top:2em;"><strong>Quick Navigation:</strong> Click any module in the navigation bar above to practice workbook scenarios.</div>
    </section>

    <!-- PATIENT REGISTRATION MODULE -->
    <section id="registration">
      <h2>Patient Registration Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> A new patient arrives at your clinic. Register them into the system, ensuring all required fields are properly completed. Pay special attention to collecting accurate contact and emergency details.
      </div>
      <form id="registrationForm" autocomplete="off">
        <label>Full Name <span style="color:#ba181b;">*</span></label>
        <input type="text" id="regName" required>
        <label>Date of Birth <span style="color:#ba181b;">*</span></label>
        <input type="date" id="regDOB" required>
        <label>Gender</label>
        <select id="regGender">
          <option value="Unspecified">Unspecified</option>
          <option>Female</option>
          <option>Male</option>
          <option>Other</option>
        </select>
        <label>Phone Number</label>
        <input type="tel" id="regPhone" pattern="^[0-9\-\+()\s]{7,20}$" placeholder="(123) 456-7890">
        <label>Email Address</label>
        <input type="email" id="regEmail" placeholder="you@email.com">
        <label>Address</label>
        <input type="text" id="regAddress">
        <label>Insurance Provider</label>
        <input type="text" id="regInsurance">
        <label>Emergency Contact Name <span style="color:#ba181b;">*</span></label>
        <input type="text" id="regEmerName" required>
        <label>Emergency Contact Number <span style="color:#ba181b;">*</span></label>
        <input type="tel" id="regEmerPhone" required>
        <button type="submit">Submit Registration</button>
        <button class="module-reset" onclick="resetModule(event,'registrationForm','regFeedback')">Reset</button>
      </form>
      <div class="feedback" id="regFeedback"></div>
    </section>

    <!-- APPOINTMENT SCHEDULING MODULE -->
    <section id="appointment">
      <h2>Appointment Scheduling Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> A registered patient contacts the office requesting an appointment with Dr. Lee for next Thursday at 10:00 AM. Use the scheduling form to check availability and schedule their appointment.
      </div>
      <form id="appointmentForm" autocomplete="off">
        <label>Patient Name <span style="color:#ba181b;">*</span></label>
        <input type="text" id="apptName" required>
        <label>Provider</label>
        <select id="apptProvider">
          <option>Dr. Lee</option>
          <option>Dr. Morgan</option>
          <option>Dr. Patel</option>
        </select>
        <label>Preferred Date <span style="color:#ba181b;">*</span></label>
        <input type="date" id="apptDate" required>
        <label>Preferred Time</label>
        <input type="time" id="apptTime" required>
        <label>Reason for Visit</label>
        <input type="text" id="apptReason">
        <button type="submit">Schedule Appointment</button>
        <button class="module-reset" onclick="resetModule(event,'appointmentForm','apptFeedback')">Reset</button>
      </form>
      <div class="feedback" id="apptFeedback"></div>
      <table id="apptTable" class="hidden">
        <thead><tr><th>Date</th><th>Time</th><th>Patient</th><th>Provider</th><th>Reason</th></tr></thead>
        <tbody id="apptList"></tbody>
      </table>
    </section>

    <!-- SOAP NOTES MODULE -->
    <section id="soap">
      <h2>SOAP Notes Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> After seeing a patient with complaints of back pain, you are required to document the encounter using the SOAP (Subjective, Objective, Assessment, Plan) format. Complete each section with the appropriate information.
      </div>
      <form id="soapForm" autocomplete="off">
        <label>Patient Name <span style="color:#ba181b;">*</span></label>
        <input type="text" id="soapName" required>
        <label>Subjective (Patient Complaint)</label>
        <textarea id="soapSubjective" required placeholder="Patient reports..."></textarea>
        <label>Objective (Examination Findings)</label>
        <textarea id="soapObjective" required placeholder="Exam reveals..."></textarea>
        <label>Assessment (Diagnosis)</label>
        <textarea id="soapAssessment" required placeholder="Most likely diagnosis is..."></textarea>
        <label>Plan (Treatment Plan)</label>
        <textarea id="soapPlan" required placeholder="Recommend..."></textarea>
        <button type="submit">Save Note</button>
        <button class="module-reset" onclick="resetModule(event, 'soapForm','soapFeedback')">Reset</button>
      </form>
      <div class="feedback" id="soapFeedback"></div>
    </section>

    <!-- INSURANCE VERIFICATION MODULE -->
    <section id="insurance">
      <h2>Insurance Verification Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> A patient is scheduled for an expensive imaging procedure. Verify the provided insurance details, noting the policy number, eligibility, and any required pre-authorizations.
      </div>
      <form id="insuranceForm" autocomplete="off">
        <label>Patient Name</label>
        <input type="text" id="insName" required>
        <label>Insurance Provider</label>
        <input type="text" id="insProvider" required>
        <label>Policy Number</label>
        <input type="text" id="insPolicy" required>
        <label>Coverage Type</label>
        <select id="insCoverage">
          <option value="PPO">PPO</option>
          <option value="HMO">HMO</option>
          <option value="Medicaid">Medicaid</option>
          <option value="Medicare">Medicare</option>
          <option value="Other">Other</option>
        </select>
        <label>Pre-Auth Required?</label>
        <select id="insAuth">
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <label>
          Eligibility Verified
          <input type="checkbox" id="insEligible" value="yes">
        </label>
        <button type="submit">Confirm Verification</button>
        <button class="module-reset" onclick="resetModule(event,'insuranceForm','insFeedback')">Reset</button>
      </form>
      <div class="feedback" id="insFeedback"></div>
    </section>

    <!-- PROVIDER MESSAGING MODULE -->
    <section id="messaging">
      <h2>Provider Messaging Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> A provider has sent you a secure message requesting you clarify a patient's medication history. Compose a reply and mark the conversation as resolved.
      </div>
      <form id="messageForm" autocomplete="off">
        <label>Provider</label>
        <select id="msgProvider">
          <option>Dr. Lee</option>
          <option>Dr. Morgan</option>
          <option>Dr. Patel</option>
        </select>
        <label>Message Subject</label>
        <input type="text" id="msgSubject" required>
        <label>Message</label>
        <textarea id="msgBody" required></textarea>
        <label>
          Mark as Resolved <input type="checkbox" id="msgResolved">
        </label>
        <button type="submit">Send Reply</button>
        <button class="module-reset" onclick="resetModule(event,'messageForm','msgFeedback')">Reset</button>
      </form>
      <div class="feedback" id="msgFeedback"></div>
      <div id="messageLog"></div>
    </section>

    <!-- DOCUMENT UPLOAD MODULE -->
    <section id="documents">
      <h2>Document Upload Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> A patient brings a PDF of their prior MRI results and a scanned insurance card. Upload both documents to their record and confirm their successful inclusion.
      </div>
      <form id="docUploadForm" autocomplete="off">
        <label>Patient Name</label>
        <input type="text" id="docName" required>
        <label>Document Type</label>
        <select id="docType">
          <option>Insurance Card</option>
          <option>Medical Report</option>
          <option>ID Proof</option>
          <option>Consent Form</option>
          <option>Other</option>
        </select>
        <label>Choose File</label>
        <input type="file" id="docFile" accept=".pdf,.jpg,.jpeg,.png,.bmp" required>
        <button type="submit">Upload Document</button>
        <button class="module-reset" onclick="resetModule(event,'docUploadForm','docFeedback')">Reset</button>
      </form>
      <div class="feedback" id="docFeedback"></div>
      <ul id="docList"></ul>
    </section>

    <!-- ROLE-BASED DASHBOARDS MODULE -->
    <!-- (Dashboard is the first section) -->

    <!-- LAB ORDERS MODULE -->
    <section id="labs">
      <h2>Lab Orders Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> The provider has ordered a Complete Blood Count (CBC) and a lipid panel for a patient. Enter the lab orders, confirm required fasting, and provide patient instructions.
      </div>
      <form id="labForm" autocomplete="off">
        <label>Patient Name</label>
        <input type="text" id="labName" required>
        <label>Lab Test(s) Ordered</label>
        <select id="labTests" multiple required style="height:4.5em;">
          <option>Complete Blood Count (CBC)</option>
          <option>Lipid Panel</option>
          <option>HbA1c</option>
          <option>Metabolic Panel</option>
          <option>COVID-19 PCR</option>
          <option>Urinalysis</option>
        </select>
        <label>
          Fasting Required?
          <input type="checkbox" id="labFasting">
        </label>
        <label>Patient Instructions</label>
        <textarea id="labInstr" required></textarea>
        <button type="submit">Submit Lab Order</button>
        <button class="module-reset" onclick="resetModule(event,'labForm','labFeedback')">Reset</button>
      </form>
      <div class="feedback" id="labFeedback"></div>
      <ul id="labOrders"></ul>
    </section>

    <!-- PRODUCTIVITY REPORTS MODULE -->
    <section id="reports">
      <h2>Productivity Reports Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> Review and benchmark your daily productivity: number of registrations, appointments scheduled, notes entered, and appeals processed. Identify areas for improvement.
      </div>
      <button class="small-btn" onclick="generateReport()">Generate Productivity Report</button>
      <div class="feedback" id="reportFeedback"></div>
      <table id="productivityTable" class="hidden">
        <thead><tr>
            <th>Metric</th><th>Count</th>
          </tr></thead>
        <tbody>
          <tr><td>Patients Registered</td><td id="prodReg"></td></tr>
          <tr><td>Appointments Scheduled</td><td id="prodAppt"></td></tr>
          <tr><td>SOAP Notes Entered</td><td id="prodSoap"></td></tr>
          <tr><td>Appeals Processed</td><td id="prodAppeals"></td></tr>
          <tr><td>Lab Orders Submitted</td><td id="prodLabs"></td></tr>
          <tr><td>Documents Uploaded</td><td id="prodDocs"></td></tr>
          <tr><td>Insurance Verifications</td><td id="prodIns"></td></tr>
        </tbody>
      </table>
    </section>

    <!-- CAREER PATH TRACKER MODULE -->
    <section id="career">
      <h2>Career Path Tracker Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> You are working toward certification as a Certified Outpatient Clinical Appeals Specialist (COCAS). Track your key milestones, CEUs earned, and credentialing progress.
      </div>
      <form id="careerForm" autocomplete="off">
        <label>Current Role</label>
        <input type="text" id="careerRole" required>
        <label>Certification Pursued</label>
        <select id="careerCert">
          <option>COCAS</option>
          <option>Registered Health Information Tech (RHIT)</option>
          <option>Certified Professional Coder (CPC)</option>
          <option>Certified Medical Office Manager (CMOM)</option>
          <option>Other</option>
        </select>
        <label>CEUs Earned</label>
        <input type="number" id="careerCEU" min="0" required>
        <label>Next Milestone/Exam Date</label>
        <input type="date" id="careerMilestone">
        <button type="submit">Update Tracker</button>
        <button class="module-reset" onclick="resetModule(event,'careerForm','careerFeedback')">Reset</button>
      </form>
      <div class="feedback" id="careerFeedback"></div>
      <ul id="careerLog"></ul>
    </section>

    <!-- APPEALS MANAGEMENT MODULE -->
    <section id="appeals">
      <h2>Appeals Management Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> A claim denial is received for an outpatient procedure, citing insufficient documentation. Prepare and submit a first-level appeal, documenting all actions and outcomes.
      </div>
      <form id="appealForm" autocomplete="off">
        <label>Patient Name</label>
        <input type="text" id="appealName" required>
        <label>Claim Number</label>
        <input type="text" id="appealClaim" required>
        <label>Reason for Denial</label>
        <input type="text" id="appealReason" required>
        <label>Appeal Justification</label>
        <textarea id="appealJustify" required></textarea>
        <label>
          Attach Documentation <input type="file" id="appealDoc" accept=".pdf,.doc,.docx,.jpg,.png">
        </label>
        <button type="submit">Submit Appeal</button>
        <button class="module-reset" onclick="resetModule(event,'appealForm','appealFeedback')">Reset</button>
      </form>
      <div class="feedback" id="appealFeedback"></div>
      <ul id="appealLog"></ul>
    </section>

    <!-- AUDIT SIMULATION MODULE -->
    <section id="audit">
      <h2>Audit Simulation Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> Simulate a compliance audit by reviewing a sample medical record for completeness and accuracy. Document any discrepancies or required corrections.
      </div>
      <form id="auditForm" autocomplete="off">
        <label>Medical Record Number</label>
        <input type="text" id="auditMRN" required>
        <label>Sections Reviewed</label>
        <select id="auditSection" multiple required style="height:4.5em;">
          <option>Registration</option>
          <option>SOAP Note</option>
          <option>Lab Orders</option>
          <option>Insurance Verification</option>
          <option>Appeals</option>
          <option>Document Upload</option>
        </select>
        <label>Discrepancies Noted</label>
        <textarea id="auditDiscrepancy"></textarea>
        <label>
          Corrections Made 
          <input type="checkbox" id="auditCorrected">
        </label>
        <button type="submit">Submit Audit</button>
        <button class="module-reset" onclick="resetModule(event,'auditForm','auditFeedback')">Reset</button>
      </form>
      <div class="feedback" id="auditFeedback"></div>
      <ul id="auditLog"></ul>
    </section>

    <!-- COMPLIANCE REVIEW MODULE -->
    <section id="compliance">
      <h2>Compliance Review Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> Review the office's handling of PHI and patient consents. Confirm compliance with HIPAA policies and document any compliance gaps.
      </div>
      <form id="complianceForm" autocomplete="off">
        <label>Review Period Start</label>
        <input type="date" id="complianceStart" required>
        <label>Review Period End</label>
        <input type="date" id="complianceEnd" required>
        <label>
          HIPAA Acknowledgments On File 
          <input type="checkbox" id="complianceHIPAA">
        </label>
        <label>
          PHI Release Authorized 
          <input type="checkbox" id="compliancePHI">
        </label>
        <label>Compliance Gaps Noted</label>
        <textarea id="complianceGaps"></textarea>
        <button type="submit">Record Review</button>
        <button class="module-reset" onclick="resetModule(event,'complianceForm','complianceFeedback')">Reset</button>
      </form>
      <div class="feedback" id="complianceFeedback"></div>
      <ul id="complianceLog"></ul>
    </section>

    <!-- ADVANCED WORKFLOWS MODULE -->
    <section id="workflows">
      <h2>Advanced Workflows Module</h2>
      <div class="scenario">
        <strong>Scenario:</strong> Simulate a multi-step new patient workflow: complete registration, then book an appointment, file insurance details, and upload required documents in sequence. The workflow tracks progress at each stage.
      </div>
      <form id="workflowForm" autocomplete="off">
        <label><input type="checkbox" id="wfReg"> Registration Completed</label><br>
        <label><input type="checkbox" id="wfAppt"> Appointment Scheduled</label><br>
        <label><input type="checkbox" id="wfIns"> Insurance Filed</label><br>
        <label><input type="checkbox" id="wfDoc"> Document Uploaded</label><br>
        <button type="submit">Validate Workflow</button>
        <button class="module-reset" onclick="resetModule(event,'workflowForm','workflowFeedback')">Reset</button>
      </form>
      <div class="feedback" id="workflowFeedback"></div>
      <ul id="workflowLog"></ul>
    </section>
  </main>
  <script>
    // --- State management ---
    let patients=[], appointments=[], soapNotes=[], insVerifications=[],
        messages=[], docs=[], labs=[], productivity={reg:0,appt:0,soap:0,appeals:0,labs:0,docs:0,ins:0},
        career=[], appeals=[], audits=[], compliance=[], workflowLog=[];

    // --- Navigation ---
    function showModule(mod) {
      document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
      document.querySelector('button[data-module="'+mod+'"]').classList.add('active');
      document.getElementById(mod).classList.add('active');
      if (mod === 'dashboard') loadDashboard();
    }

    document.querySelectorAll('nav button').forEach(btn=>{
      btn.onclick = function(){ showModule(this.getAttribute('data-module')) }
    });

    // --- DASHBOARD dynamic metrics ---
    function loadDashboard() {
      document.getElementById('dashboard-appointments').innerHTML = appointments.length ?
        `<b>${appointments.length}</b> scheduled<br>${appointments.map(a=>a.date+' @ '+a.time).join('<br>')}`:"No appointments";
      document.getElementById('dashboard-patients').innerText = patients.length+" total";
      document.getElementById('dashboard-messages').innerText = messages.filter(m=>!m.resolved).length + " open";
      let prod = `<b>Notes:</b> ${soapNotes.length}<br><b>Labs:</b> ${labs.length}`;
      document.getElementById('dashboard-productivity').innerHTML = prod;
    }
    loadDashboard();

    // --- PATIENT REGISTRATION ---
    document.getElementById('registrationForm').onsubmit = function(e){
      e.preventDefault();
      let name = regName.value.trim(),
          emerg = regEmerName.value.trim(),
          emergPhone = regEmerPhone.value.trim();
      if(!name||!regDOB.value||!emerg||!emergPhone){
        feedback('regFeedback', "Please complete all required fields.", true); return;
      }
      patients.push({
        name, dob: regDOB.value, gender: regGender.value, phone: regPhone.value,
        email: regEmail.value, address: regAddress.value, insurance: regInsurance.value,
        emerName: emerg, emerPhone: emergPhone
      });
      productivity.reg++;
      feedback('regFeedback', "Patient registered successfully! ("+name+")");
      loadDashboard();
    }

    // --- APPOINTMENT SCHEDULING ---
    document.getElementById('appointmentForm').onsubmit = function(e){
      e.preventDefault();
      let name = apptName.value.trim(),
          date = apptDate.value, time = apptTime.value, provider = apptProvider.value, reason = apptReason.value;
      if(!name||!date||!time){
        feedback('apptFeedback', "All required fields must be filled.", true); return;
      }
      appointments.push({name, provider, date, time, reason});
      productivity.appt++;
      feedback('apptFeedback', `Appointment scheduled for ${name} with ${provider} on ${date} at ${time}.`);
      updateApptTable();
      loadDashboard();
    }
    function updateApptTable() {
      let tbl = document.getElementById('apptTable');
      let list = document.getElementById('apptList');
      if (appointments.length === 0){ tbl.classList.add('hidden'); return;}
      list.innerHTML = appointments.map(a=>`
        <tr><td>${a.date}</td><td>${a.time}</td><td>${a.name}</td><td>${a.provider}</td><td>${a.reason||'-'}</td></tr>
      `).join('');
      tbl.classList.remove('hidden');
    }

    // --- SOAP NOTES ---
    document.getElementById('soapForm').onsubmit = function(e){
      e.preventDefault();
      let name = soapName.value.trim(), subj = soapSubjective.value.trim();
      if(!name||!subj||!soapObjective.value.trim()||!soapAssessment.value.trim()||!soapPlan.value.trim()){
        feedback('soapFeedback', "Please complete all fields of the SOAP note.", true); return;
      }
      soapNotes.push({
        name, S: soapSubjective.value, O: soapObjective.value, 
        A: soapAssessment.value, P: soapPlan.value
      });
      productivity.soap++;
      feedback('soapFeedback', "SOAP Note for "+name+" saved. Remember to securely file all clinical documentation.");
    }

    // --- INSURANCE VERIFICATION ---
    document.getElementById('insuranceForm').onsubmit = function(e){
      e.preventDefault();
      let name=insName.value.trim(), provider=insProvider.value.trim(), policy=insPolicy.value.trim();
      if(!name||!provider||!policy){ feedback('insFeedback',"Please enter all insurance details.",true);return;}
      let eligible = insEligible.checked ? "Eligibility verified" : "Eligibility not verified";
      let authReq = insAuth.value==="Yes" ? "Pre-auth required." : "No pre-auth.";
      productivity.ins++;
      insVerifications.push({name, provider, policy, type:insCoverage.value, eligible, authReq});
      feedback('insFeedback',
        `Insurance for ${name} confirmed. ${eligible}. ${authReq}`);
    }

    // --- PROVIDER MESSAGING ---
    document.getElementById('messageForm').onsubmit = function(e){
      e.preventDefault();
      let provider=msgProvider.value,subject=msgSubject.value.trim(), body=msgBody.value.trim(), resolved=msgResolved.checked;
      if(!subject||!body){ feedback('msgFeedback','Please enter subject and message.',true); return;}
      messages.push({provider,subject,body,resolved});
      feedback('msgFeedback',`Message sent to ${provider}. Conversation marked as ${resolved?'resolved':'pending'}.`);
      logMessages();
    }
    function logMessages(){
      let log = document.getElementById('messageLog');
      if (!messages.length){log.innerHTML=""; return;}
      log.innerHTML = `<h4>Message Log</h4><ul>`+messages.map(m=>`<li><b>${m.provider}:</b> ${m.subject} (${m.resolved?'Resolved':'Open'})</li>`).join('')+"</ul>";
    }

    // --- DOCUMENT UPLOAD ---
    document.getElementById('docUploadForm').onsubmit = function(e){
      e.preventDefault();
      let name = docName.value.trim(), file = docFile.files[0], type = docType.value;
      if(!name||!file){ feedback('docFeedback','Please specify patient and select a file.',true); return;}
      docs.push({name,type,file:file.name});
      productivity.docs++;
      feedback('docFeedback','Document uploaded for '+name+': '+file.name);
      updateDocList();
    }
    function updateDocList(){
      let list = document.getElementById('docList');
      if(docs.length===0){list.innerHTML=""; return;}
      list.innerHTML = docs.map(d=>`<li>${d.name}: ${d.type} (${d.file})</li>`).join('');
    }

    // --- LAB ORDERS ---
    document.getElementById('labForm').onsubmit = function(e){
      e.preventDefault();
      let name=labName.value.trim(), tests=Array.from(labTests.selectedOptions).map(o=>o.value), fasting=labFasting.checked, instr=labInstr.value.trim();
      if(!name||tests.length===0||!instr) {feedback('labFeedback',"Please specify patient, select at least one test, and add instructions.",true); return;}
      labs.push({name,tests:tests.join(', '),fasting,instr});
      productivity.labs++;
      feedback('labFeedback',`Lab order for ${name} submitted. Tests: ${tests.join(', ')}. ${fasting?"Fasting required. ":""}Instructions: ${instr}`);
      updateLabOrders();
    }
    function updateLabOrders(){
      let list = document.getElementById('labOrders');
      if(labs.length===0){list.innerHTML="";return;}
      list.innerHTML = labs.map(l=>`<li>${l.name}: ${l.tests} | ${l.fasting?'Fasting':''}</li>`).join('');
    }

    // --- PRODUCTIVITY REPORTS ---
    function generateReport(){
      document.getElementById('prodReg').innerText = productivity.reg;
      document.getElementById('prodAppt').innerText = productivity.appt;
      document.getElementById('prodSoap').innerText = productivity.soap;
      document.getElementById('prodAppeals').innerText = productivity.appeals || appeals.length;
      document.getElementById('prodLabs').innerText = productivity.labs;
      document.getElementById('prodDocs').innerText = productivity.docs;
      document.getElementById('prodIns').innerText = productivity.ins;
      document.getElementById('productivityTable').classList.remove('hidden');
      feedback('reportFeedback',"Daily productivity report generated.");
    }

    // --- CAREER PATH TRACKER ---
    document.getElementById('careerForm').onsubmit = function(e){
      e.preventDefault();
      let role=careerRole.value.trim(), cert=careerCert.value, ceu=careerCEU.value, milestone=careerMilestone.value;
      if(!role||ceu===""){ feedback('careerFeedback', "Enter role and CEUs.",true); return; }
      career.push({role,cert,ceu,milestone});
      feedback('careerFeedback',"Tracker updated. Stay on track toward certification!");
      updateCareerLog();
    }
    function updateCareerLog(){
      let log = document.getElementById('careerLog');
      if(!career.length){ log.innerHTML=""; return;}
      log.innerHTML = career.map(c=> `<li>${c.role} | ${c.cert} | CEUs: ${c.ceu}${c.milestone?" | Next: "+c.milestone:""}</li>`).join('');
    }

    // --- APPEALS MANAGEMENT ---
    document.getElementById('appealForm').onsubmit = function(e){
      e.preventDefault();
      let name=appealName.value.trim(), claim=appealClaim.value.trim(), reason=appealReason.value.trim(), justification=appealJustify.value.trim();
      if(!name||!claim||!reason||!justification) {feedback('appealFeedback',"Please fill out all fields.",true);return;}
      appeals.push({name,claim,reason,just:justification,doc:appealDoc.files[0]?appealDoc.files[0].name:""});
      productivity.appeals++;
      feedback('appealFeedback', "Appeal submitted for "+name+". Track payer response within 7 days.");
      updateAppealLog();
    }
    function updateAppealLog(){
      let log = document.getElementById('appealLog');
      if(!appeals.length){log.innerHTML="";return;}
      log.innerHTML = appeals.map(a=>`<li>Claim: ${a.claim} (${a.name}), Reason: ${a.reason}, Doc: ${a.doc||'N/A'}</li>`).join('');
    }

    // --- AUDIT SIMULATION ---
    document.getElementById('auditForm').onsubmit = function(e){
      e.preventDefault();
      let mrn = auditMRN.value.trim(), secs = Array.from(auditSection.selectedOptions).map(o=>o.value), disc = auditDiscrepancy.value.trim(), corr = auditCorrected.checked;
      if(!mrn||secs.length===0){feedback('auditFeedback',"Specify record and at least one section.",true);return;}
      audits.push({mrn,secs:secs.join(', '),disc,corr});
      feedback('auditFeedback',"Audit recorded: "+ (corr?"Corrections made.":"Needs follow up."));
      updateAuditLog();
    }
    function updateAuditLog(){
      let log = document.getElementById('auditLog');
      if(!audits.length){ log.innerHTML=""; return;}
      log.innerHTML = audits.map(a=>`<li>${a.mrn}: ${a.secs} | ${a.disc?("Issue: "+a.disc):"No issues"} | Corrected: ${a.corr?'Yes':'No'}</li>`).join('');
    }

    // --- COMPLIANCE REVIEW ---
    document.getElementById('complianceForm').onsubmit = function(e){
      e.preventDefault();
      let s=complianceStart.value, e_=complianceEnd.value, hipaa=complianceHIPAA.checked, phi=compliancePHI.checked, gaps=complianceGaps.value.trim();
      if(!s||!e_) {feedback('complianceFeedback',"Set review period dates.",true); return;}
      compliance.push({s,e_,hipaa,phi,gaps});
      feedback('complianceFeedback', `Compliance review recorded. All records ${hipaa&&phi?"in order":"require attention"}.`);
      updateComplianceLog();
    }
    function updateComplianceLog(){
      let log = document.getElementById('complianceLog');
      if(!compliance.length){log.innerHTML="";return;}
      log.innerHTML = compliance.map(c=>`<li>${c.s}–${c.e_}. HIPAA:${c.hipaa?'✔':'❌'}, PHI:${c.phi?'✔':'❌'}${c.gaps?' | Gaps: '+c.gaps:""}</li>`).join('');
    }

    // --- ADVANCED WORKFLOWS ---
    document.getElementById('workflowForm').onsubmit = function(e){
      e.preventDefault();
      let valid = wfReg.checked&&wfAppt.checked&&wfIns.checked&&wfDoc.checked;
      workflowLog.push({
        reg:wfReg.checked, appt:wfAppt.checked, ins:wfIns.checked, doc:wfDoc.checked,
        success:valid
      });
      feedback('workflowFeedback', valid? "All workflow steps complete! Patient onboarding workflow validated.":"Incomplete workflow. Ensure each step is checked off.", !valid);
      updateWorkflowLog();
    }
    function updateWorkflowLog(){
      let log = document.getElementById('workflowLog');
      if(!workflowLog.length){log.innerHTML="";return;}
      log.innerHTML = workflowLog.map((w,i)=>`<li>Attempt ${i+1}: ${w.reg?"✔":"❌"} Registration, ${w.appt?"✔":"❌"} Appt, ${w.ins?"✔":"❌"} Ins, ${w.doc?"✔":"❌"} Doc. Result: ${w.success?"Success":"Fail"}</li>`).join('');
    }

    // --- COMMON FEEDBACK AND RESET ---
    function feedback(feedbackId,message,error){
      let el = document.getElementById(feedbackId);
      el.innerHTML = message;
      el.style.display = 'block';
      if(error) el.classList.add('error'); else el.classList.remove('error');
      setTimeout(()=>{ el.style.display='none'; }, error? 4000:2500 );
    }
    function resetModule(e,formId,feedbackId){
      e.preventDefault();
      document.getElementById(formId).reset();
      if(feedbackId) document.getElementById(feedbackId).style.display='none';
    }

    // Initialize module-dependent lists on each navigation
    document.querySelectorAll('nav button').forEach(btn=>{
      btn.addEventListener('click', function(){
        let mod = this.getAttribute('data-module');
        if(mod==='appointment') updateApptTable();
        if(mod==='documents') updateDocList();
        if(mod==='labs') updateLabOrders();
        if(mod==='career') updateCareerLog();
        if(mod==='appeals') updateAppealLog();
        if(mod==='audit') updateAuditLog();
        if(mod==='compliance') updateComplianceLog();
        if(mod==='workflows') updateWorkflowLog();
        if(mod==='messaging') logMessages();
      });
    });
  </script>
</body>
</html>
